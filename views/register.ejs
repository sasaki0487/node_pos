<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="/js/frontend.js"></script>
</head>
<body>
  <h1>Register</h1>
  <table>
      <tr>
          <th>ID</th>
          <td id="id"></td>
      </tr>
      <tr>
          <th>Name</th>
          <td><input type="text" id="name" name="name"></td>
      </tr>
      <tr>
          <th>Stock</th>
          <td><input type="text" id="stock" name="stock"></td>
      </tr>
      <tr>
          <th>In price</th>
          <td><input type="text" id="inPrice" name="inPrice"></td>
      </tr>
      <tr>
          <th>Out price</th>
          <td><input type="text" id="outPrice" name="outPrice"></td>
      </tr>
  </table>
  <button type="button" id="register">Register</button>
  <script>
    window.onload = function(){
      postData('/getRegisterId', {})
      .then(data => {
        document.querySelector("#id").innerHTML = data.body.ID;
      })
      .catch(error => {
        alert(error);
      });
    }
    
    document.querySelector('#register').onclick = function(){
      var data = {
        id: document.querySelector("#id").innerHTML,
        name: document.querySelector("#name").value,
        stock: document.querySelector("#stock").value,
        inPrice: document.querySelector("#inPrice").value,
        outPrice: document.querySelector("#outPrice").value
      };

      postData('/register', data)
      .then(data => {
        alert(data.body.res);
        if(data.status == '200'){
          postData('/getRegisterId',{})
          .then(data => {
            document.querySelector("#id").innerHTML = data.body.ID;
          })
          .catch(error => {
            alert(error);
          });
          document.querySelector("#name").value = '';
          document.querySelector("#stock").value = '';
          document.querySelector("#inPrice").value = '';
          document.querySelector("#outPrice").value = '';
        }
      })
      .catch(error => {
        alert(error);
      });
    };
  </script>
</body>
</html>